{"ast":null,"code":"import React,{useEffect,useState,useContext}from\"react\";import{useParams,Link}from\"react-router-dom\";import axios from\"axios\";import{AuthContext}from\"../../context/AuthContext\";// ‚úÖ fixed path\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function BookDetails(){var _book$issuedTo,_book$issuedTo2;const{id}=useParams();const{auth}=useContext(AuthContext);// ‚úÖ updated to match your AuthContext structure\nconst user=auth.user;const[book,setBook]=useState(null);const[loading,setLoading]=useState(true);// Fetch book details\nconst fetchBook=async()=>{try{const{data}=await axios.get(\"/api/books/\".concat(id),{headers:{Authorization:\"Bearer \".concat(auth.token)}});setBook(data);}catch(err){console.error(\"‚ùå Error fetching book details:\",err);}finally{setLoading(false);}};useEffect(()=>{fetchBook();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[id]);// Issue Book\nconst handleIssueBook=async()=>{try{await axios.put(\"/api/books/\".concat(book._id,\"/issue\"),{},{headers:{Authorization:\"Bearer \".concat(auth.token)}});alert(\"‚úÖ Book issued successfully\");fetchBook();}catch(err){var _err$response,_err$response$data;alert(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||\"Error issuing book\");}};// Return Book\nconst handleReturnBook=async()=>{try{await axios.put(\"/api/books/\".concat(book._id,\"/return\"),{},{headers:{Authorization:\"Bearer \".concat(auth.token)}});alert(\"üì¶ Book returned successfully\");fetchBook();}catch(err){var _err$response2,_err$response2$data;alert(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||\"Error returning book\");}};if(loading)return/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"});if(!book)return/*#__PURE__*/_jsx(\"p\",{children:\"Book not found\"});const issuedToCurrentUser=book.issuedTo&&book.issuedTo._id===(user===null||user===void 0?void 0:user._id);return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsx(Link,{to:\"/books\",className:\"text-purple-600 flex items-center mb-4\",children:\"\\u2190 Back to Books\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-6 flex\",children:[/*#__PURE__*/_jsx(\"img\",{src:book.coverImage||\"/default-cover.jpg\",alt:book.title,className:\"w-48 h-64 object-cover rounded shadow mr-6\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col flex-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"bg-purple-100 text-purple-800 px-2 py-1 rounded text-sm w-fit mb-2\",children:book.category}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold mb-2\",children:book.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 mb-4\",children:[\"by \",book.author]}),book.isIssued&&/*#__PURE__*/_jsxs(\"p\",{className:\"mb-4 text-sm text-gray-700\",children:[\"\\uD83D\\uDCCC Issued to: \",/*#__PURE__*/_jsx(\"strong\",{children:(_book$issuedTo=book.issuedTo)===null||_book$issuedTo===void 0?void 0:_book$issuedTo.name}),\" (\",(_book$issuedTo2=book.issuedTo)===null||_book$issuedTo2===void 0?void 0:_book$issuedTo2.email,\")\"]}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold\",children:\"Description\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 mb-4\",children:book.description}),/*#__PURE__*/_jsxs(\"div\",{children:[!book.isIssued&&/*#__PURE__*/_jsx(\"button\",{onClick:handleIssueBook,className:\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\",children:\"Issue Book\"}),book.isIssued&&issuedToCurrentUser&&/*#__PURE__*/_jsx(\"button\",{onClick:handleReturnBook,className:\"bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600\",children:\"Return Book\"}),book.isIssued&&!issuedToCurrentUser&&/*#__PURE__*/_jsx(\"button\",{className:\"bg-gray-400 text-white px-4 py-2 rounded cursor-not-allowed\",disabled:true,children:\"Not Available\"})]})]})]})]});}","map":{"version":3,"names":["React","useEffect","useState","useContext","useParams","Link","axios","AuthContext","jsx","_jsx","jsxs","_jsxs","BookDetails","_book$issuedTo","_book$issuedTo2","id","auth","user","book","setBook","loading","setLoading","fetchBook","data","get","concat","headers","Authorization","token","err","console","error","handleIssueBook","put","_id","alert","_err$response","_err$response$data","response","message","handleReturnBook","_err$response2","_err$response2$data","children","issuedToCurrentUser","issuedTo","className","to","src","coverImage","alt","title","category","author","isIssued","name","email","description","onClick","disabled"],"sources":["C:/Users/frank/OneDrive/Desktop/mini-library/library-frontend/src/components/books/BookDetails.js"],"sourcesContent":[" import React, { useEffect, useState, useContext } from \"react\";\r\nimport { useParams, Link } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport { AuthContext } from \"../../context/AuthContext\"; // ‚úÖ fixed path\r\n\r\nexport default function BookDetails() {\r\n  const { id } = useParams();\r\n  const { auth } = useContext(AuthContext); // ‚úÖ updated to match your AuthContext structure\r\n  const user = auth.user;\r\n\r\n  const [book, setBook] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Fetch book details\r\n  const fetchBook = async () => {\r\n    try {\r\n      const { data } = await axios.get(`/api/books/${id}`, {\r\n        headers: { Authorization: `Bearer ${auth.token}` }\r\n      });\r\n      setBook(data);\r\n    } catch (err) {\r\n      console.error(\"‚ùå Error fetching book details:\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchBook();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [id]);\r\n\r\n  // Issue Book\r\n  const handleIssueBook = async () => {\r\n    try {\r\n      await axios.put(`/api/books/${book._id}/issue`, {}, {\r\n        headers: { Authorization: `Bearer ${auth.token}` }\r\n      });\r\n      alert(\"‚úÖ Book issued successfully\");\r\n      fetchBook();\r\n    } catch (err) {\r\n      alert(err.response?.data?.message || \"Error issuing book\");\r\n    }\r\n  };\r\n\r\n  // Return Book\r\n  const handleReturnBook = async () => {\r\n    try {\r\n      await axios.put(`/api/books/${book._id}/return`, {}, {\r\n        headers: { Authorization: `Bearer ${auth.token}` }\r\n      });\r\n      alert(\"üì¶ Book returned successfully\");\r\n      fetchBook();\r\n    } catch (err) {\r\n      alert(err.response?.data?.message || \"Error returning book\");\r\n    }\r\n  };\r\n\r\n  if (loading) return <p>Loading...</p>;\r\n  if (!book) return <p>Book not found</p>;\r\n\r\n  const issuedToCurrentUser =\r\n    book.issuedTo && book.issuedTo._id === user?._id;\r\n\r\n  return (\r\n    <div className=\"p-4\">\r\n      <Link to=\"/books\" className=\"text-purple-600 flex items-center mb-4\">\r\n        ‚Üê Back to Books\r\n      </Link>\r\n\r\n      <div className=\"bg-white rounded-lg shadow p-6 flex\">\r\n        {/* Book Cover */}\r\n        <img\r\n          src={book.coverImage || \"/default-cover.jpg\"}\r\n          alt={book.title}\r\n          className=\"w-48 h-64 object-cover rounded shadow mr-6\"\r\n        />\r\n\r\n        {/* Book Info */}\r\n        <div className=\"flex flex-col flex-1\">\r\n          <span className=\"bg-purple-100 text-purple-800 px-2 py-1 rounded text-sm w-fit mb-2\">\r\n            {book.category}\r\n          </span>\r\n\r\n          <h1 className=\"text-3xl font-bold mb-2\">{book.title}</h1>\r\n          <p className=\"text-gray-600 mb-4\">by {book.author}</p>\r\n\r\n          {book.isIssued && (\r\n            <p className=\"mb-4 text-sm text-gray-700\">\r\n              üìå Issued to: <strong>{book.issuedTo?.name}</strong> ({book.issuedTo?.email})\r\n            </p>\r\n          )}\r\n\r\n          <h2 className=\"text-lg font-semibold\">Description</h2>\r\n          <p className=\"text-gray-700 mb-4\">{book.description}</p>\r\n\r\n          {/* Action Buttons */}\r\n          <div>\r\n            {!book.isIssued && (\r\n              <button\r\n                onClick={handleIssueBook}\r\n                className=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\"\r\n              >\r\n                Issue Book\r\n              </button>\r\n            )}\r\n\r\n            {book.isIssued && issuedToCurrentUser && (\r\n              <button\r\n                onClick={handleReturnBook}\r\n                className=\"bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600\"\r\n              >\r\n                Return Book\r\n              </button>\r\n            )}\r\n\r\n            {book.isIssued && !issuedToCurrentUser && (\r\n              <button\r\n                className=\"bg-gray-400 text-white px-4 py-2 rounded cursor-not-allowed\"\r\n                disabled\r\n              >\r\n                Not Available\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}